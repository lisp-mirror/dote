;; dawn of the Era: a tactical game.
;; Copyright (C) 2015  cage

;; This program is free software: you can redistribute it and/or modify
;; it under the terms of the GNU General Public License as published by
;; the Free Software Foundation, either version 3 of the License, or
;; (at your option) any later version.

;; This program is distributed in the hope that it will be useful,
;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;; GNU General Public License for more details.

;; You should have received a copy of the GNU General Public License
;; along with this program.  If not, see <http://www.gnu.org/licenses/>.

(in-package :interpolation-test)

(defsuite interpolation-suite (all-suite))

(defun hermite-2d ()
  (let ((k0 (sb-cga:vec  0.0  0.0 0.0))
        (k1 (sb-cga:vec  10.0 10.0 0.0))
        (k2 (sb-cga:vec 10.0 -20.0 0.0))
        (k3 (sb-cga:vec 0.0 0.0 0.0)))
    (alexandria:flatten
     (loop for i from 0.0 to 1.0 by 0.01 collect
          (let* ((res (hermite-polynomial k0 k1 k2 k3 i))
                 (a   (matrix:matrix-elt res 0 0))
                 (b   (matrix:matrix-elt res 1 0)))
            (list a b))))))

(defun c-m-interpolation ()
  (let* ((knots (list (vec  0.0  0.0 0.0)
                      (vec 10.0 10.0 0.0)
                      (vec 20.0  5.0 0.0)
                      (vec 10.0  0.0 0.0)
                      (vec  0.0  0.0 0.0)))
         (interpolator (catmul-roll-interpolation* knots)))
    (alexandria:flatten
     (loop for i from 0.0 to 5.0 by 0.01 collect
          (let* ((res (funcall interpolator i))
                 (a   (matrix:matrix-elt res 0 0))
                 (b   (matrix:matrix-elt res 1 0)))
            (list a b))))))

(deftest test-c-m-interpolation (interpolation-suite)
  (assert-true
      (equalp (c-m-interpolation)
              (list 0.0 0.0
                    0.0029799999 0.003475
                    0.011839999 0.013799999
                    0.026460001
                    0.030825  0.046719998 0.054399997
                    0.07249999 0.08437499
                    0.103679985 0.120599985
                    0.14013997 0.16292496
                    0.18175995 0.21119994
                    0.22841993 0.2652749
                    0.2799999
                    0.3249999 0.3363799
                    0.39022487 0.39743987
                    0.46079984 0.46305987
                    0.53657484
                    0.5331199 0.61739993
                    0.60749996 0.70312494
                    0.6860799 0.7935999
                    0.76874006
                    0.8886751 0.85536003
                    0.98820007 0.94582015
                    1.0920252 1.0400002
                    1.2000003
                    1.1377801 1.3119751
                    1.2390401 1.4278002
                    1.3436604 1.5473254
                    1.4515203
                    1.6704004 1.5625002
                    1.7968752 1.6764802
                    1.9266002 1.7933402
                    2.059425 1.91296
                    2.1952 2.0352197
                    2.3337746 2.1599998
                    2.475 2.2871797
                    2.6187246 2.4166396
                    2.7647996 2.5482595
                    2.9130745 2.6819193
                    3.0633993 2.8174994
                    3.2156243 2.954879
                    3.3695989 3.0939386
                    3.5251734 3.2345583
                    3.682198 3.3766186
                    3.8405235 3.519998
                    3.9999979 3.6645782
                    4.160473 3.810238
                    4.321798 3.956858
                    4.483823 4.1043177
                    4.6463976 4.2524977
                    4.8093724 4.4012775
                    4.972597 4.5505376
                    5.1359224 4.700157
                    5.2991967 4.850017
                    5.4622717 4.999997
                    5.624997 5.149977
                    5.787222 5.2998376
                    5.948797 5.449457
                    6.109572 5.598717
                    6.269397 5.7474957
                    6.4281206 5.8956766
                    6.5855966 6.0431366
                    6.7416716 6.1897564
                    6.8961964 6.335416
                    7.049021 6.4799957
                    7.1999955 6.623377
                    7.348972 6.765435
                    7.4957952 6.906056
                    7.640321 7.0451164
                    7.7823963 7.1824956
                    7.92187 7.318075
                    8.058595 7.4517355
                    8.192421 7.5833554
                    8.323195 7.7128153
                    8.45077 7.8399944
                    8.574994 7.9647756
                    8.695721 8.087034
                    8.812795 8.2066555
                    8.926071 8.323516
                    9.035397 8.437496
                    9.140621 8.548476
                    9.241596 8.656336
                    9.338171 8.760956
                    9.430197 8.862215
                    9.517521 8.959995
                    9.599996 9.054175
                    9.677471 9.144635
                    9.749796 9.2312565
                    9.816822 9.313916
                    9.878397 9.392496
                    9.934372 9.466875
                    9.984596 9.536935
                    10.028921 9.602556
                    10.067198 9.663616
                    10.099273 9.719996
                    10.124998 9.771576
                    10.144222 9.818239
                    10.156801 9.859858
                    10.162575 9.896318
                    10.161401 9.9275
                    10.153128 9.953278
                    10.1376 9.973537
                    10.1146755 9.98816
                    10.084203 9.99702
                    10.046028 10.000001
                    10.000004 10.00397
                    9.949756 10.015759
                    9.899024 10.035189
                    9.84782 10.062078
                    9.796163 10.096248
                    9.744066 10.137517
                    9.691544 10.185707
                    9.638612 10.240636
                    9.585284 10.302125
                    9.531576 10.369995
                    9.477504 10.444064
                    9.423081 10.524155
                    9.368325 10.610085
                    9.313247 10.7016735
                    9.257865 10.798742
                    9.202192 10.901112
                    9.146244 11.008601
                    9.090036 11.121032
                    9.033584 11.23822
                    8.976901 11.35999
                    8.920006 11.486159
                    8.862906 11.6165495
                    8.805624 11.750978
                    8.748171 11.889269
                    8.690565 12.031238
                    8.632818 12.176707
                    8.5749445 12.325499
                    8.516963 12.477427
                    8.458885 12.632317
                    8.400728 12.789986
                    8.342505 12.950255
                    8.284233 13.112945
                    8.2259245 13.277875
                    8.167599 13.444864
                    8.109265 13.613734
                    8.050943 13.784304
                    7.9926453 13.956393
                    7.9343877 14.129823
                    7.8761854 14.304414
                    7.8180532
                    14.479982 7.760006
                    14.656353 7.7020583
                    14.833342 7.644226
                    15.010773 7.5865235
                    15.188461 7.528966
                    15.366232 7.4715686
                    15.543901 7.4143457
                    15.721292 7.357313
                    15.898221 7.300486
                    16.074512 7.243879
                    16.24998 7.187506
                    16.42445 7.1313834
                    16.59774 7.075526
                    16.769672 7.0199485
                    16.940062 6.9646664
                    17.10873 6.9096937
                    17.275501 6.8550463
                    17.440191 6.8007393
                    17.602621 6.7467856
                    17.762611
                    6.6932034 17.919983
                    6.640006 18.074553
                    6.5872087 18.226143
                    6.5348263 18.374573
                    6.482874 18.51966
                    6.431366 18.661232
                    6.380319 18.799103
                    6.3297462 18.933094
                    6.2796636 19.063025
                    6.230086 19.188713
                    6.181029 19.309984
                    6.1325064 19.426655
                    6.0845337 19.538546
                    6.037126 19.645475
                    5.9902987 19.747267
                    5.944066 19.843737
                    5.8984437 19.93471
                    5.853446 20.019999
                    5.8090878 20.099428
                    5.765386 20.172821
                    5.722353 20.239992
                    5.680006 20.300762
                    5.638358 20.354956
                    5.597425 20.402384
                    5.557223 20.442875
                    5.517765 20.476248
                    5.4790673 20.502316
                    5.441145 20.520906
                    5.404012 20.531841
                    5.3676844 20.53493
                    5.332178 20.530003
                    5.2975044 20.51687
                    5.2636824 20.495361
                    5.2307253 20.465294
                    5.198647 20.426487
                    5.1674643 20.378756
                    5.1371922 20.321932
                    5.107844 20.255821
                    5.0794363 20.18025
                    5.051984 20.095045
                    5.025501 20.000015
                    5.000004 19.899025
                    4.9740114 19.796095
                    4.946064 19.691286
                    4.9162073 19.584656
                    4.884485 19.476265
                    4.850942 19.366177
                    4.815625 19.254446
                    4.778578 19.141138
                    4.739846 19.026308
                    4.699474 18.910019
                    4.657507 18.792326
                    4.613989 18.673298
                    4.568967 18.55299
                    4.5224853 18.431458
                    4.4745874 18.308771
                    4.4253206 18.184978
                    4.3747277 18.06015
                    4.322856 17.934341
                    4.2697487 17.80761
                    4.2154512 17.680021
                    4.1600094 17.55163
                    4.1034665 17.4225
                    4.0458694 17.292692
                    3.9872622 17.162262
                    3.92769 17.031273
                    3.8671978 16.89978
                    3.80583 16.767853
                    3.7436333 16.635544
                    3.680651 16.502914
                    3.6169286 16.370024
                    3.5525112 16.23693
                    3.4874434 16.103703
                    3.4217715 15.970393
                    3.355539 15.837064
                    3.288792 15.703774
                    3.2215745 15.570583
                    3.153932 15.437554
                    3.0859098 15.304745
                    3.0175524
                    15.1722145 2.948905
                    15.040024 2.8800125
                    14.908234 2.81092
                    14.776904 2.7416728
                    14.646094 2.6723154
                    14.515863 2.6028929
                    14.386274 2.5334504
                    14.257383 2.464033
                    14.129253 2.3946855
                    14.001944 2.325453
                    13.875513 2.2563806
                    13.750024 2.187513
                    13.625533 2.1188955
                    13.502104 2.0505733
                    13.379795 1.9825909
                    13.258663
                    1.9149932 13.138773
                    1.8478254 13.020184
                    1.7811332 12.902954
                    1.7149608
                    12.787142 1.6493527
                    12.672813 1.5843556
                    12.560022 1.520013
                    12.448832 1.45637
                    12.339302 1.3934724
                    12.231492 1.3313651
                    12.125462 1.2700922
                    12.021271
                    1.2096996 11.918982
                    1.1502323 11.818651
                    1.0917348 11.720339
                    1.0342516 11.62411
                    0.9778293 11.53002
                    0.9225115 11.438129
                    0.8683439 11.348498
                    0.81537104
                    11.2611885 0.7636385
                    11.176258 0.7131908
                    11.093767 0.664073
                    11.013777
                    0.61632985 10.936347
                    0.57000786 10.861535
                    0.52514935 10.789406
                    0.481802
                    10.7200165 0.44000953
                    10.653424 0.39981604
                    10.589695 0.36126867
                    10.528882
                    0.32441005 10.471052
                    0.28928727 10.416263
                    0.25594518 10.364571
                    0.22442684
                    10.31604 0.19477859
                    10.270729 0.1670456
                    10.228699 0.14127299
                    10.190008
                    0.117505044 10.154718
                    0.09578779 10.122887
                    0.076164305 10.094577
                    0.058681667
                    10.069846 0.04338354
                    10.048755 0.03031537
                    10.031364 0.01952231
                    10.017735
                    0.011049956 10.007922
                    0.004941374 10.001991
                    0.0012432039 10.0
                    0.0 9.997022
                    0.0
                    9.988163 0.0
                    9.973544 0.0
                    9.953285 0.0
                    9.927507 0.0
                    9.896328 0.0
                    9.859869 0.0
                    9.818251 0.0
                    9.771592 0.0
                    9.720013 0.0
                    9.663635 0.0
                    9.602575 0.0
                    9.536957 0.0
                    9.466898 0.0
                    9.392519 0.0
                    9.31394 0.0
                    9.231282 0.0
                    9.144663 0.0
                    9.054204 0.0
                    8.960025 0.0
                    8.862246 0.0
                    8.760987 0.0
                    8.656367 0.0
                    8.548509 0.0
                    8.43753 0.0
                    8.323551 0.0
                    8.206691 0.0
                    8.087072 0.0
                    7.964813 0.0
                    7.840033 0.0
                    7.7128544 0.0
                    7.583395 0.0
                    7.4517756 0.0
                    7.318116 0.0
                    7.182537 0.0
                    7.0451574 0.0
                    6.9060984
                    0.0 6.765479
                    0.0 6.623419
                    0.0 6.48004
                    0.0 6.3354607
                    0.0 6.1898003
                    0.0 6.043181
                    0.0 5.895722
                    0.0 5.747542
                    0.0 5.598762
                    0.0 5.4495025
                    0.0 5.299883
                    0.0
                    5.1500225 0.0
                    5.000043 0.0
                    4.850063 0.0
                    4.700203 0.0
                    4.550583 0.0
                    4.401324 0.0
                    4.2525434 0.0
                    4.1043634 0.0
                    3.9569032 0.0
                    3.8102822 0.0
                    3.6646225 0.0
                    3.520043
                    0.0 3.3766625
                    0.0 3.234602
                    0.0 3.0939817
                    0.0 2.9549217
                    0.0 2.8175414
                    0.0
                    2.6819606 0.0
                    2.5482993 0.0
                    2.4166799 0.0
                    2.287219 0.0
                    2.1600385 0.0
                    2.0352573
                    0.0 1.9129974
                    0.0 1.7933768
                    0.0 1.6765159
                    0.0 1.5625352
                    0.0 1.4515531
                    0.0
                    1.3436937 0.0
                    1.2390727 0.0
                    1.137811 0.0
                    1.0400295 0.0
                    0.9458494 0.0
                    0.85538745 0.0
                    0.7687664 0.0
                    0.6861043 0.0
                    0.6075251 0.0
                    0.5331433 0.0
                    0.4630816 0.0
                    0.39745927 0.0
                    0.33639908 0.0
                    0.28001785 0.0
                    0.228436 0.0
                    0.1817751 0.0
                    0.14015317 0.0
                    0.103690624 0.0
                    0.07250905 0.0
                    0.046727657 0.0
                    0.026466846 0.0
                    0.011843443 0.0
                    0.0029826164 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0 0.0
                    0.0
                    0.0 0.0 0.0))))

(defun de-boor-interpolation ()
  (let* ((v (vector  (vec 1.0 10.0 0.0)
                     (vec 2.0 10.0 0.0)
                     (vec 2.0 20.0 0.0)
                     (vec 1.0 20.0 0.0)
                     (vec 1.0 10.0 0.0)))
         (deg        3))
    (multiple-value-bind (interpolator from-s to-s)
        (db-interpolation v :degree deg :pad-control-points t)
      (alexandria:flatten (loop for s from from-s
                             to   to-s by 0.01        collect
                               (misc:seq->list (funcall interpolator s)))))))

(deftest test-deboor-interpolation (interpolation-suite)
  (assert-true
      (equalp (de-boor-interpolation)
              (list 1.0 10.000001 0.0
                    1.0 9.999999 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 9.999999 0.0
                    1.0 9.999999 0.0
                    1.0000001 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 9.999999 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0000001 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 9.999999 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 9.999999 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 9.999999 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    0.9999999 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 9.999999 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 9.999999 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 9.999999 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0000001 10.000001 0.0
                    1.0 10.0 0.0
                    1.0000001 10.0 0.0
                    1.0 9.999999 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 9.999999 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.000001 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    1.0000001 10.000001 0.0
                    1.0000014 10.000001 0.0
                    1.0000045 10.0 0.0
                    1.0000106 10.0 0.0
                    1.0000209 10.0 0.0
                    1.000036 10.0 0.0
                    1.0000571 9.999999 0.0
                    1.0000854 10.0 0.0
                    1.0001216 10.0 0.0
                    1.0001667 10.0 0.0
                    1.0002218 10.0 0.0
                    1.000288 10.0 0.0
                    1.0003662 10.0 0.0
                    1.0004574 10.0 0.0
                    1.0005625 10.000001 0.0
                    1.0006826 10.0 0.0
                    1.0008188 10.000001 0.0
                    1.000972 10.0 0.0
                    1.0011432 10.0 0.0
                    1.0013335 10.000001 0.0
                    1.0015436 10.0 0.0
                    1.0017748 10.0 0.0
                    1.0020279 10.000001 0.0
                    1.0023041 10.0 0.0
                    1.0026042 10.0 0.0
                    1.0029294 10.0 0.0
                    1.0032808 10.000001 0.0
                    1.0036589 10.0 0.0
                    1.0040652 10.0 0.0
                    1.0045003 10.000001 0.0
                    1.0049654 10.0 0.0
                    1.0054617 10.0 0.0
                    1.0059899 10.0 0.0
                    1.006551 10.0 0.0
                    1.0071462 10.0 0.0
                    1.0077765 10.0 0.0
                    1.0084426 10.0 0.0
                    1.0091459 10.0 0.0
                    1.0098871 10.0 0.0
                    1.0106672 9.999999 0.0
                    1.0114876 10.0 0.0
                    1.0123488 10.0 0.0
                    1.0132519 9.999999 0.0
                    1.0141983 10.0 0.0
                    1.0151885 10.0 0.0
                    1.0162237 10.0 0.0
                    1.0173049 9.999999 0.0
                    1.0184332 10.0 0.0
                    1.0196093 9.999999 0.0
                    1.0208347 10.0 0.0
                    1.02211 10.0 0.0
                    1.0234362 10.000001 0.0
                    1.0248144 10.0 0.0
                    1.0262457 10.0 0.0
                    1.027731 10.0 0.0
                    1.0292711 10.0 0.0
                    1.0308675 10.000001 0.0
                    1.0325208 10.000001 0.0
                    1.034232 10.000001 0.0
                    1.0360023 10.0 0.0
                    1.0378325 9.999999 0.0
                    1.0397239 10.0 0.0
                    1.0416771 10.0 0.0
                    1.0436934 10.0 0.0
                    1.0457737 10.000001 0.0
                    1.047919 10.0 0.0
                    1.0501304 9.999999 0.0
                    1.0524087 9.999999 0.0
                    1.0547551 10.0 0.0
                    1.0571704 10.000001 0.0
                    1.0596557 9.999999 0.0
                    1.0622121 10.0 0.0
                    1.0648403 10.0 0.0
                    1.0675417 10.0 0.0
                    1.070317 10.0 0.0
                    1.0731676 10.0 0.0
                    1.0760938 9.999999 0.0
                    1.0790972 10.0 0.0
                    1.0821786 10.0 0.0
                    1.085339 10.0 0.0
                    1.0885793 10.000001 0.0
                    1.0919006 10.0 0.0
                    1.095304 10.0 0.0
                    1.0987905 10.0 0.0
                    1.1023608 10.000001 0.0
                    1.1060163 9.999999 0.0
                    1.1097577 10.0 0.0
                    1.1135861 10.0 0.0
                    1.1175025 9.999999 0.0
                    1.121508 10.0 0.0
                    1.1256033 10.0 0.0
                    1.1297898 10.0 0.0
                    1.1340683 10.0 0.0
                    1.1384398 10.0 0.0
                    1.1429052 10.0 0.0
                    1.1474657 10.000001 0.0
                    1.1521221 10.0 0.0
                    1.1568756 9.999999 0.0
                    1.1617272 10.0 0.0
                    1.1666776 10.0 0.0
                    1.1717277 10.000002 0.0
                    1.1768756 10.000012 0.0
                    1.1821197 10.000047 0.0
                    1.1874576 10.000107 0.0
                    1.1928878 10.00021 0.0
                    1.1984076 10.0003605 0.0
                    1.2040155 10.000571 0.0
                    1.2097096 10.0008545 0.0
                    1.2154877 10.001217 0.0
                    1.2213476 10.001669 0.0
                    1.2272875 10.002219 0.0
                    1.2333057 10.002882 0.0
                    1.2393996 10.003663 0.0
                    1.2455676 10.004576 0.0
                    1.2518077 10.005628 0.0
                    1.2581176 10.006829 0.0
                    1.2644956 10.008192 0.0
                    1.2709396 10.009724 0.0
                    1.2774475 10.0114355 0.0
                    1.2840177 10.013339 0.0
                    1.2906475 10.015441 0.0
                    1.2973355 10.017753 0.0
                    1.3040794 10.020287 0.0
                    1.3108773 10.023047 0.0
                    1.3177273 10.026051 0.0
                    1.3246274 10.029303 0.0
                    1.3315753 10.032815 0.0
                    1.3385693 10.036597 0.0
                    1.3456072 10.040661 0.0
                    1.3526871 10.045012 0.0
                    1.3598071 10.049665 0.0
                    1.366965 10.054629 0.0
                    1.3741589 10.059912 0.0
                    1.3813869 10.065524 0.0
                    1.3886468 10.071476 0.0
                    1.3959366 10.07778 0.0
                    1.4032546 10.084443 0.0
                    1.4105985 10.091475 0.0
                    1.4179665 10.098889 0.0
                    1.4253564 10.106691 0.0
                    1.4327662 10.114895 0.0
                    1.4401941 10.1235075 0.0
                    1.4476379 10.132541 0.0
                    1.4550959 10.142005 0.0
                    1.4625658 10.151908 0.0
                    1.4700457 10.16226 0.0
                    1.4775335 10.173074 0.0
                    1.4850272 10.184358 0.0
                    1.4925251 10.196121 0.0
                    1.500025 10.208375 0.0
                    1.5075248 10.221128 0.0
                    1.5150226 10.234393 0.0
                    1.5225166 10.248176 0.0
                    1.5300044 10.26249 0.0
                    1.5374842 10.277344 0.0
                    1.544954 10.292748 0.0
                    1.5524116 10.308712 0.0
                    1.5598555 10.325245 0.0
                    1.5672834 10.3423605 0.0
                    1.574693 10.360064 0.0
                    1.5820829 10.378368 0.0
                    1.5894506 10.397283 0.0
                    1.5967942 10.416818 0.0
                    1.6041121 10.436982 0.0
                    1.6114018 10.457786 0.0
                    1.6186614 10.47924 0.0
                    1.6258892 10.501355 0.0
                    1.633083 10.52414 0.0
                    1.6402406 10.5476055 0.0
                    1.6473604 10.57176 0.0
                    1.65444 10.596615 0.0
                    1.6614776 10.622179 0.0
                    1.6684712 10.648465 0.0
                    1.675419 10.67548 0.0
                    1.6823184 10.703235 0.0
                    1.689168 10.73174 0.0
                    1.6959658 10.761005 0.0
                    1.7027093 10.79104 0.0
                    1.7093971 10.821857 0.0
                    1.7160265 10.853462 0.0
                    1.722596 10.885867 0.0
                    1.7291037 10.919084 0.0
                    1.7355472 10.953119 0.0
                    1.7419248 10.987985 0.0
                    1.7482344 11.023691 0.0
                    1.7544738 11.060247 0.0
                    1.7606413 11.097664 0.0
                    1.7667347 11.135949 0.0
                    1.7727523 11.175117 0.0
                    1.7786919 11.215173 0.0
                    1.7845511 11.256129 0.0
                    1.7903286 11.297995 0.0
                    1.7960222 11.340782 0.0
                    1.8016294 11.384499 0.0
                    1.8071488 11.429154 0.0
                    1.8125782 11.474762 0.0
                    1.8179157 11.52133 0.0
                    1.823159 11.568866 0.0
                    1.8283063 11.617383 0.0
                    1.8333557 11.666891 0.0
                    1.8383054 11.717394 0.0
                    1.8431551 11.768875 0.0
                    1.8479048 11.821318 0.0
                    1.8525543 11.874699 0.0
                    1.857104 11.929001 0.0
                    1.8615538 11.984204 0.0
                    1.8659034 12.040286 0.0
                    1.870153 12.097228 0.0
                    1.8743025 12.155009 0.0
                    1.8783522 12.213612 0.0
                    1.8823019 12.273013 0.0
                    1.8861514 12.333196 0.0
                    1.8899012 12.394138 0.0
                    1.8935506 12.455817 0.0
                    1.8971003 12.51822 0.0
                    1.9005499 12.581322 0.0
                    1.9038993 12.6451025 0.0
                    1.9071488 12.709544 0.0
                    1.9102986 12.774625 0.0
                    1.9133482 12.840327 0.0
                    1.9162978 12.906627 0.0
                    1.9191473 12.973508 0.0
                    1.9218969 13.04095 0.0
                    1.9245465 13.108931 0.0
                    1.927096 13.177431 0.0
                    1.9295455 13.246432 0.0
                    1.931895 13.315912 0.0
                    1.9341445 13.385853 0.0
                    1.9362941 13.456233 0.0
                    1.9383436 13.527034 0.0
                    1.9402931 13.598233 0.0
                    1.9421428 13.669814 0.0
                    1.9438922 13.741755 0.0
                    1.9455416 13.814034 0.0
                    1.9470913 13.886635 0.0
                    1.9485408 13.959535 0.0
                    1.9498901 14.032714 0.0
                    1.9511399 14.106154 0.0
                    1.9522892 14.179833 0.0
                    1.9533386 14.253734 0.0
                    1.9542884 14.327833 0.0
                    1.9551377 14.402112 0.0
                    1.9558872 14.47655 0.0
                    1.9565365 14.551129 0.0
                    1.957086 14.625828 0.0
                    1.9575355 14.700627 0.0
                    1.9578851 14.775506 0.0
                    1.9581345 14.850446 0.0
                    1.9582839 14.925423 0.0
                    1.9583334 15.000422 0.0
                    1.9582827 15.07542 0.0
                    1.9581323 15.150398 0.0
                    1.9578817 15.225337 0.0
                    1.9575312 15.300217 0.0
                    1.9570806 15.375013 0.0
                    1.95653 15.449711 0.0
                    1.9558792 15.524288 0.0
                    1.9551287 15.598725 0.0
                    1.9542781 15.673002 0.0
                    1.9533274 15.747099 0.0
                    1.952277 15.820997 0.0
                    1.9511261 15.894673 0.0
                    1.9498756 15.968111 0.0
                    1.948525 16.041286 0.0
                    1.9470743 16.114185 0.0
                    1.9455237 16.18678 0.0
                    1.9438729 16.259058 0.0
                    1.9421223 16.330992 0.0
                    1.9402719 16.402569 0.0
                    1.9383212 16.473764 0.0
                    1.9362706 16.544561 0.0
                    1.9341199 16.614937 0.0
                    1.9318691 16.684872 0.0
                    1.9295185 16.754349 0.0
                    1.9270678 16.823343 0.0
                    1.9245172 16.891838 0.0
                    1.9218665 16.959812 0.0
                    1.9191159 17.027248 0.0
                    1.9162651 17.094124 0.0
                    1.9133142 17.160418 0.0
                    1.9102637 17.22611 0.0
                    1.907113 17.291185 0.0
                    1.9038622 17.35562 0.0
                    1.9005115 17.419392 0.0
                    1.8970609 17.482487 0.0
                    1.89351 17.54488 0.0
                    1.8898593 17.606552 0.0
                    1.8861086 17.667486 0.0
                    1.8822578 17.72766 0.0
                    1.8783071 17.787054 0.0
                    1.8742565 17.845646 0.0
                    1.8701057 17.903418 0.0
                    1.865855 17.96035 0.0
                    1.8615041 18.016422 0.0
                    1.8570534 18.071615 0.0
                    1.8525027 18.125908 0.0
                    1.847852 18.17928 0.0
                    1.843101 18.231709 0.0
                    1.8382503 18.28318 0.0
                    1.8332994 18.333672 0.0
                    1.8282489 18.383165 0.0
                    1.8231004 18.43166 0.0
                    1.8178561 18.479155 0.0
                    1.8125176 18.525648 0.0
                    1.8070873 18.571146 0.0
                    1.801567 18.615637 0.0
                    1.7959585 18.659134 0.0
                    1.7902641 18.701626 0.0
                    1.7844858 18.743118 0.0
                    1.7786254 18.783613 0.0
                    1.772685 18.823107 0.0
                    1.7666667 18.8616 0.0
                    1.7605723 18.899096 0.0
                    1.7544041 18.935589 0.0
                    1.7481637 18.971083 0.0
                    1.7418532 19.005575 0.0
                    1.7354752 19.03907 0.0
                    1.7290308 19.071564 0.0
                    1.7225224 19.103056 0.0
                    1.7159524 19.13355 0.0
                    1.709322 19.163044 0.0
                    1.7026339 19.19154 0.0
                    1.6958896 19.21903 0.0
                    1.6890913 19.245525 0.0
                    1.6822412 19.271017 0.0
                    1.675341 19.29551 0.0
                    1.6683927 19.319002 0.0
                    1.6613986 19.341496 0.0
                    1.6543607 19.362991 0.0
                    1.6472805 19.383484 0.0
                    1.6401602 19.402975 0.0
                    1.6330023 19.421469 0.0
                    1.625808 19.438961 0.0
                    1.6185799 19.455452 0.0
                    1.61132 19.470947 0.0
                    1.6040298 19.485437 0.0
                    1.5967118 19.498932 0.0
                    1.589368 19.511427 0.0
                    1.5819998 19.522915 0.0
                    1.5746098 19.53341 0.0
                    1.5671998 19.542904 0.0
                    1.5597719 19.551394 0.0
                    1.5523279 19.558887 0.0
                    1.54487 19.56538 0.0
                    1.5374 19.570873 0.0
                    1.52992 19.575363 0.0
                    1.5224322 19.578856 0.0
                    1.5149384 19.581348 0.0
                    1.5074404 19.582842 0.0
                    1.4999406 19.583334 0.0
                    1.4924408 19.582825 0.0
                    1.4849432 19.581318 0.0
                    1.4774492 19.578808 0.0
                    1.4699615 19.5753 0.0
                    1.4624816 19.570793 0.0
                    1.455012 19.565285 0.0
                    1.4475542 19.558779 0.0
                    1.4401104 19.551268 0.0
                    1.4326826 19.54276 0.0
                    1.4252731 19.53325 0.0
                    1.4178835 19.522745 0.0
                    1.4105158 19.511236 0.0
                    1.4031723 19.498726 0.0
                    1.3958545 19.485218 0.0
                    1.388565 19.470709 0.0
                    1.3813053 19.4552 0.0
                    1.3740779 19.43869 0.0
                    1.3668842 19.421185 0.0
                    1.3597268 19.402676 0.0
                    1.3526071 19.383165 0.0
                    1.3455276 19.362656 0.0
                    1.3384902 19.341148 0.0
                    1.3314968 19.318638 0.0
                    1.3245494 19.295132 0.0
                    1.31765 19.27062 0.0
                    1.3108007 19.245113 0.0
                    1.3040032 19.218601 0.0
                    1.2972598 19.191093 0.0
                    1.2905725 19.162582 0.0
                    1.2839433 19.133076 0.0
                    1.277374 19.102566 0.0
                    1.2708666 19.071054 0.0
                    1.2644235 19.038548 0.0
                    1.2580462 19.005037 0.0
                    1.251737 18.970528 0.0
                    1.2454978 18.93502 0.0
                    1.2393305 18.898508 0.0
                    1.2332375 18.861 0.0
                    1.2272204 18.82249 0.0
                    1.2212813 18.78298 0.0
                    1.2154222 18.742472 0.0
                    1.2096452 18.70096 0.0
                    1.2039521 18.658453 0.0
                    1.1983451 18.61494 0.0
                    1.192826 18.570429 0.0
                    1.1873971 18.524921 0.0
                    1.1820601 18.47841 0.0
                    1.176817 18.430899 0.0
                    1.1716703 18.382391 0.0
                    1.1666213 18.33288 0.0
                    1.1616719 18.282373 0.0
                    1.1568216 18.230888 0.0
                    1.1520692 18.17844 0.0
                    1.1474138 18.125051 0.0
                    1.1428545 18.070747 0.0
                    1.1383901 18.015543 0.0
                    1.1340195 17.959455 0.0
                    1.1297423 17.902512 0.0
                    1.1255568 17.844725 0.0
                    1.1214623 17.786116 0.0
                    1.117458 17.726713 0.0
                    1.1135426 17.666527 0.0
                    1.109715 17.605583 0.0
                    1.1059747 17.5439 0.0
                    1.1023201 17.481493 0.0
                    1.0987507 17.418386 0.0
                    1.0952653 17.354603 0.0
                    1.0918629 17.29016 0.0
                    1.0885423 17.225075 0.0
                    1.085303 17.15937 0.0
                    1.0821434 17.093067 0.0
                    1.0790629 17.026186 0.0
                    1.0760604 16.958742 0.0
                    1.0731349 16.890757 0.0
                    1.0702854 16.822254 0.0
                    1.067511 16.753252 0.0
                    1.0648103 16.68377 0.0
                    1.0621828 16.613827 0.0
                    1.0596274 16.543444 0.0
                    1.0571429 16.472641 0.0
                    1.0547283 16.401438 0.0
                    1.0523826 16.329857 0.0
                    1.0501051 16.257915 0.0
                    1.0478946 16.185633 0.0
                    1.04575 16.113031 0.0
                    1.0436705 16.040133 0.0
                    1.0416548 15.966949 0.0
                    1.0397023 15.893511 0.0
                    1.0378116 15.819829 0.0
                    1.035982 15.745928 0.0
                    1.0342125 15.671827 0.0
                    1.0325018 15.5975485 0.0
                    1.0308491 15.523107 0.0
                    1.0292537 15.448529 0.0
                    1.027714 15.37383 0.0
                    1.0262293 15.299029 0.0
                    1.0247986 15.224151 0.0
                    1.0234209 15.149213 0.0
                    1.0220952 15.074232 0.0
                    1.0208206 14.999234 0.0
                    1.019596 14.924237 0.0
                    1.0184202 14.849258 0.0
                    1.0172925 14.774322 0.0
                    1.0162117 14.699443 0.0
                    1.0151771 14.624646 0.0
                    1.0141873 14.549949 0.0
                    1.0132416 14.475371 0.0
                    1.0123389 14.400934 0.0
                    1.0114781 14.326658 0.0
                    1.0106583 14.252561 0.0
                    1.0098786 14.178666 0.0
                    1.0091377 14.10499 0.0
                    1.008435 14.031552 0.0
                    1.0077692 13.958378 0.0
                    1.0071394 13.885483 0.0
                    1.0065446 13.812888 0.0
                    1.0059837 13.740613 0.0
                    1.005456 13.668678 0.0
                    1.0049601 13.597104 0.0
                    1.0044953 13.525909 0.0
                    1.0040604 13.455115 0.0
                    1.0036544 13.384742 0.0
                    1.0032766 13.314808 0.0
                    1.0029256 13.245336 0.0
                    1.0026008 13.176342 0.0
                    1.002301 13.10785 0.0
                    1.002025 13.039877 0.0
                    1.001772 12.972445 0.0
                    1.0015411 12.905574 0.0
                    1.0013311 12.839281 0.0
                    1.0011412 12.77359 0.0
                    1.0009702 12.708518 0.0
                    1.0008173 12.644087 0.0
                    1.0006813 12.580317 0.0
                    1.0005614 12.517226 0.0
                    1.0004562 12.454836 0.0
                    1.0003653 12.393166 0.0
                    1.0002873 12.332236 0.0
                    1.0002211 12.272066 0.0
                    1.0001662 12.212677 0.0
                    1.0001211 12.154089 0.0
                    1.000085 12.096319 0.0
                    1.0000569 12.039391 0.0
                    1.0000359 11.983323 0.0
                    1.0000207 11.928135 0.0
                    1.0000106 11.873847 0.0
                    1.0000044 11.820479 0.0
                    1.0000013 11.768052 0.0
                    1.0000002 11.716586 0.0
                    1.0 11.6661 0.0
                    1.0 11.616609 0.0
                    1.0 11.568107 0.0
                    0.99999994 11.520584 0.0
                    1.0 11.474032 0.0
                    1.0 11.428441 0.0
                    1.0 11.3838005 0.0
                    1.0 11.340096 0.0
                    1.0 11.297325 0.0
                    0.99999994 11.255473 0.0
                    1.0 11.214532 0.0
                    1.0 11.174489 0.0
                    1.0 11.135337 0.0
                    0.99999994 11.097065 0.0
                    1.0000001 11.059662 0.0
                    1.0 11.023119 0.0
                    1.0 10.987427 0.0
                    1.0 10.952574 0.0
                    0.99999994 10.9185505 0.0
                    0.99999994 10.885348 0.0
                    1.0000001 10.852956 0.0
                    1.0 10.821363 0.0
                    1.0 10.790559 0.0
                    1.0 10.760536 0.0
                    1.0000001 10.731284 0.0
                    1.0000001 10.70279 0.0
                    1.0 10.675048 0.0
                    1.0 10.648043 0.0
                    1.0000001 10.62177 0.0
                    1.0 10.596216 0.0
                    0.99999994 10.571372 0.0
                    0.99999994 10.547228 0.0
                    1.0 10.523774 0.0
                    1.0 10.501 0.0
                    1.0 10.478895 0.0
                    1.0000001 10.457453 0.0
                    1.0 10.436657 0.0
                    1.0 10.416503 0.0
                    1.0 10.396978 0.0
                    0.99999994 10.378074 0.0
                    1.0 10.359779 0.0
                    1.0 10.342085 0.0
                    0.99999994 10.32498 0.0
                    0.99999994 10.3084545 0.0
                    1.0 10.2925005 0.0
                    1.0 10.277104 0.0
                    0.99999994 10.2622595 0.0
                    1.0 10.247954 0.0
                    1.0 10.234179 0.0
                    1.0 10.220922 0.0
                    1.0000001 10.208177 0.0
                    1.0 10.195931 0.0
                    1.0 10.1841755 0.0
                    1.0 10.172899 0.0
                    0.99999994 10.162093 0.0
                    1.0 10.151747 0.0
                    0.99999994 10.141851 0.0
                    1.0 10.132395 0.0
                    0.99999994 10.123368 0.0
                    1.0 10.114761 0.0
                    1.0 10.106565 0.0
                    1.0 10.098768 0.0
                    0.99999994 10.091362 0.0
                    1.0 10.084334 0.0
                    1.0 10.077677 0.0
                    1.0 10.07138 0.0
                    1.0000001 10.065433 0.0
                    1.0 10.059825 0.0
                    0.9999999 10.054547 0.0
                    1.0 10.049589 0.0
                    1.0 10.044943 0.0
                    1.0 10.040594 0.0
                    1.0 10.036535 0.0
                    1.0 10.032757 0.0
                    1.0 10.02925 0.0
                    1.0 10.026 0.0
                    1.0 10.023003 0.0
                    1.0 10.020244 0.0
                    1.0 10.017715 0.0
                    1.0 10.015407 0.0
                    1.0 10.013307 0.0
                    1.0 10.011409 0.0
                    1.0 10.009699 0.0
                    1.0 10.00817 0.0
                    1.0 10.006809 0.0
                    1.0 10.00561 0.0
                    1.0 10.004561 0.0
                    1.0 10.003652 0.0
                    1.0 10.002871 0.0
                    0.99999994 10.00221 0.0
                    1.0 10.001659 0.0
                    1.0 10.001209 0.0
                    1.0 10.00085 0.0
                    1.0 10.000569 0.0
                    1.0 10.000358 0.0
                    1.0 10.000206 0.0
                    1.0 10.000106 0.0
                    1.0 10.000044 0.0
                    1.0 10.000013 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 9.999999 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 9.999999 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 9.999999 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 9.999999 0.0
                    0.99999994 10.0 0.0
                    1.0 10.000001 0.0
                    1.0000001 10.0 0.0
                    1.0000001 10.0 0.0
                    1.0 10.000001 0.0
                    0.99999994 10.0 0.0
                    0.9999999 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0000001 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0000001 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 9.999999 0.0
                    1.0000001 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.000001 0.0
                    1.0000001 10.000001 0.0
                    1.0000001 9.999999 0.0
                    0.99999994 10.0 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0000001 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 9.999999 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0000001 10.0 0.0
                    1.0 10.0 0.0
                    0.9999999 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    0.99999994 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.000001 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0
                    1.0 10.0 0.0))))
